{% extends 'base.html' %}
{% load i18n %}
{% block title %} {% trans "Главная" %} - Balkan Pearl{% endblock %}

{% block content %}
<div class="content-container" style="display: flex; flex-wrap: nowrap; height: calc(100vh - 120px);">
    <!-- Левый блок: Описание и контакты -->
    <section class="description" style="flex: 1; padding: 20px; overflow-y: auto; min-width: 300px;">
        <h2>{% trans "Описание отеля" %}</h2>
        <p>
            {{ hotel.description|default:"Описание недоступно." }}
        </p>
        <h3>Контакты</h3>
        <ul>
            <li><strong>{% trans "Адрес" %}:</strong> {{ hotel.address|default:"Не указан" }}</li>
            <li><strong>{% trans "Электронная почта" %}:</strong>
                <a href="mailto:{{ hotel.contact_email }}">{{ hotel.contact_email|default:"Нет данных" }}</a>
            </li>
            <li><strong>{% trans "Телефон" %}:</strong>
                <a href="tel:{{ hotel.contact_phone }}">{{ hotel.contact_phone|default:"Нет данных" }}</a>
            </li>
        </ul>
    </section>

    <!-- Правый блок: Карусель и карта -->
    <section class="map-carousel-section" style="flex: 2; padding: 20px; display: flex; flex-direction: column; justify-content: space-between;">
        <div class="carousel-container" style="flex: 1; margin-bottom: 20px;">
            <h3>Фото отеля</h3>
            <div class="carousel" style="position: relative; text-align: center;">
                <button class="prev">&laquo;</button>
                <img id="carousel-image" src="" alt="Фото отеля" style="max-width: 100%; max-height: 300px; display: block; margin: 0 auto;">
                <button class="next">&raquo;</button>
            </div>
        </div>

        <div class="map-container" style="flex: 1; width=100%; height=80%">
            <h3>{% trans "Найти нас на карте" %}</h3>
            <iframe
                width="100%"
                height="75%"
                style="border: 0;"
                loading="lazy"
                allowfullscreen
                referrerpolicy="no-referrer-when-downgrade"
                title="{% trans 'Карта расположения отеля' %}"
                aria-label="{% trans 'Карта расположения отеля' %}"
                src="https://www.google.com/maps/embed/v1/place?key={{ google_maps_key }}&q={{ search_query|urlencode }}&zoom=15">
            </iframe>
            <p>
                <a href="{{ hotel.get_google_maps_url }}" target="_blank" class="map-link">
                    {% trans "Открыть в Google Картах" %}
                </a>
            </p>
        </div>
    </section>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const prevButton = document.querySelector('.prev');
    const nextButton = document.querySelector('.next');
    const carouselImage = document.querySelector('#carousel-image');

    // Получение списка изображений
    const photos = [
        {% for photo in hotel_photos %}
        { url: "{{ photo.photo.url }}", alt: "{{ photo.description|default:'Фото отеля' }}" },
        {% endfor %}
    ];

    let currentIndex = 0;

    // Функция для обновления изображения
    function updateImage() {
        const photo = photos[currentIndex];
        carouselImage.src = photo.url;
        carouselImage.alt = photo.alt;
    }

    // Обработчики для кнопок
    prevButton.addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + photos.length) % photos.length;
        updateImage();
    });

    nextButton.addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % photos.length;
        updateImage();
    });

    // Инициализация карусели
    updateImage();
});
</script>
{% endblock %}
